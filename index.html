<!DOCTYPE html>
<html>

<head>
  <title>Hello World!</title>
</head>

<body>
  <script>require('./menu.js')</script>

  <h1>Sample App with Electron</h1>
  We are using io.js
  <script>
    document.write(process.version)
  </script>
  and Electron
  <script>
    document.write(process.versions['electron'])
  </script>.

  <input id="TextInput" type="text" />

  <div id="holder" style="background-color:blue;color:white;">
    Drag your file here
	<br/>
	<br/>
	<br/>
  </div>
  
  <label id="xslx-out"></label>

  <script>
  var xlsx = require('node-xlsx');

    var holder = document.getElementById('holder');
    holder.ondragover = function() {
      return false;
    };

    holder.ondragleave = holder.ondragend = function() {
      return false;
    };

    holder.ondrop = function(e) {
      e.preventDefault();
      var file = e.dataTransfer.files[0];

      var obj = xlsx.parse(file.path); // parses a file

	  var label = document.getElementById('xslx-out');
	  var text = 'Content: ';
	  
	  for(sheetIdx in obj){
		var sheet = obj[sheetIdx];
		  for(rowIdx in sheet){
			text += '\r\n';
			var row = sheet[rowIdx];
			for(colIdx in row){
				text += '\r\n';
				var col = row[colIdx];
				text += col;
			}
		  }
		}
		label.innerHTML = text;
		
      console.log('File you dragged here is', file.path);
      return false;
    };
  </script>
</body>

</html>
